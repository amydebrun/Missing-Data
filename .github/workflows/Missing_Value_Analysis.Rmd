---
title: "missingness analysis"
author: "Amy, Kent"
date: "2025-02-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mice)
library(tidyverse)
library(haven)
library(lme4)
library(broom.mixed)
library(meta)
library(dplyr)
source("R scripts/Functions.R")
source("R scripts/VITAL data formats.R")
source("R scripts/Acupuncture data formats.R")
source("R scripts/Category time analysis.R")
source("R scripts/Continuous time analysis.R")
source("R scripts/Different Imputation Method.R")
```

To do
- Sensitivity Analysis
- Time as continuous and as factor
- Including BMI in Vital



# Category time analysis

```{r}
# Acupuncture result
print(cbind(properties, acu_result))
# Acupuncture plot
acu_plot_categorical
```

```{r}
# Fish oil result
print(cbind(properties, vital_result_oil))
# VitD result
print(cbind(properties, vital_result_vitd))
# VITAL plot
vital_plot_categorical
```

# Treat time as continuous variable

```{r}
# Acupunture
# Result table
acu_cont_result
# Compare with categorical time result
acu_compare_result
# Plot to compare (green is time cont)
acu_plot_compare
```

```{r}
# Fishoil result
vital_result_oil_cont
# Compare with category time
oil_compare_result

# VitD result
vital_result_vitd_cont
# Compare with category time
vitd_compare_result

# Comparing plot
vital_plot_compare
```


# Different Imputation Method

```{r}
# Acupuncture result
print(acu_impt_result)
# Acupuncture plot
acu_plot_imp
```

```{r}
# Fish oil result
print(vital_impt_result_vitd)
# VitD result
print(vital_impt_result_oil)
# VITAL plot
vital_plot_impt
```