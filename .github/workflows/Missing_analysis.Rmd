---
title: "missingness analysis"
author: "Amy, Kent"
date: "2025-02-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mice)
```

## R Markdown


```{r}
data_main <- read_sas("Data/VITAL_trial_NEJM_2022.sas7bdat", 
                      NULL)
acupuncture <- read_csv("Data/acupuncture.csv",show_col_types = FALSE)
head(data_main)
```

## Treatment Effect

```{r}
library(zoo)
LOCF_vital<-as.data.frame(na.locf(data_main, fromLast=TRUE))
```

```{r}
LOCF_acupuncture<-as.data.frame(na.locf(acupuncture, fromLast=TRUE))
```

```{r}
#treatment effect for acupuncture LOCF
library(sjPlot)
acu_model<- lm(pk2~group+sex+migraine+pk1+chronicity, data=acupuncture)
LOCF_acu_model<- lm(pk2~group+sex+migraine+pk1+chronicity, data=LOCF_acupuncture)
tab_model(acu_model, LOCF_acu_model)
```

```{r}
#treatment effect for vital LOCF

```


## Mice package

```{r}
mice(
  data_main,
  m = 5,
  method = NULL,
  predictorMatrix,
  ignore = NULL,
  where = NULL,
  blocks,
  visitSequence = NULL,
  formulas,
  blots = NULL,
  post = NULL,
  defaultMethod = c("pmm", "logreg", "polyreg", "polr"),
  maxit = 5,
  printFlag = TRUE,
  seed = NA,
  data.init = NULL
)
```
```{r}
library(sjPlot)
acu_mice<- mice(acupuncture, m = 5, method = 'pmm', seed = 123)
acu_mice_model <- with(acu_mice, lm(pk2~group+sex+migraine+pk1+chronicity))
pooled_model<- pool(acu_mice_model)
summary(pooled_model)
```

